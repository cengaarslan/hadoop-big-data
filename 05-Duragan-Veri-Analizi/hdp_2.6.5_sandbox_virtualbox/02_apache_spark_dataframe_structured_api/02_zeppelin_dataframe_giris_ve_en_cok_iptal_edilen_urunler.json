{"paragraphs":[{"text":"%pyspark\nspark.version","user":"anonymous","dateUpdated":"2019-07-19T15:33:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"'2.2.0.2.6.4.0-91'\n"}]},"apps":[],"jobName":"paragraph_1563550052133_-1936094187","id":"20190425-074402_372856702","dateCreated":"2019-07-19T15:27:32+0000","dateStarted":"2019-07-19T15:33:57+0000","dateFinished":"2019-07-19T15:33:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7210"},{"text":"%md\n## Spark veri okuma ve dataframe oluşturma","user":"anonymous","dateUpdated":"2019-07-19T15:39:20+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Spark veri okuma ve dataframe oluşturma</h2>\n"}]},"apps":[],"jobName":"paragraph_1563550236010_155879172","id":"20190719-153036_1312272267","dateCreated":"2019-07-19T15:30:36+0000","dateStarted":"2019-07-19T15:39:20+0000","dateFinished":"2019-07-19T15:39:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7211"},{"text":"%pyspark\ndf = spark.read.format(\"csv\").option(\"header\",True).option(\"sep\",\",\").option(\"inferSchema\",True).load(\"/user/erkan/simple_data.csv\")","user":"anonymous","dateUpdated":"2019-07-19T15:33:37+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1563550052145_-1928399209","id":"20190425-074449_2057262128","dateCreated":"2019-07-19T15:27:32+0000","dateStarted":"2019-07-19T15:33:37+0000","dateFinished":"2019-07-19T15:33:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7212"},{"text":"%md\n## Spark dataframe ","user":"anonymous","dateUpdated":"2019-07-19T15:39:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Spark dataframe</h2>\n"}]},"apps":[],"jobName":"paragraph_1563550772636_1677345413","id":"20190719-153932_826464879","dateCreated":"2019-07-19T15:39:32+0000","dateStarted":"2019-07-19T15:39:57+0000","dateFinished":"2019-07-19T15:39:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7213"},{"text":"%pyspark\ndf.show()","user":"anonymous","dateUpdated":"2019-07-19T15:33:47+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+--------+---+-----------+--------+-----------+\n|sirano|    isim|yas|     meslek|   sehir|aylik_gelir|\n+------+--------+---+-----------+--------+-----------+\n|     1|   Cemal| 35|       Isci|  Ankara|       3500|\n|     2|   Ceyda| 42|      Memur| Kayseri|       4200|\n|     3|   Timur| 30|   Müzisyen|Istanbul|       9000|\n|     4|   Burcu| 29|Pazarlamaci|  Ankara|       4200|\n|     5| Yasemin| 23|Pazarlamaci|   Bursa|       4800|\n|     6|     Ali| 33|      Memur|  Ankara|       4250|\n|     7|   Dilek| 29|Pazarlamaci|Istanbul|       7300|\n|     8|   Murat| 31|   Müzisyen|Istanbul|      12000|\n|     9|   Ahmet| 33|     Doktor|  Ankara|      18000|\n|    10|Muhittin| 46|     Berber|Istanbul|      12000|\n|    11|Hicaziye| 47| Tuhafiyeci|  Ankara|       4800|\n|    12|   Harun| 43|    Tornacı|  Ankara|       4200|\n|    13|   Hakkı| 33|      Memur|   Çorum|       3750|\n|    14| Gülizar| 37|     Doktor|   İzmir|      14250|\n|    15|  Şehmuz| 41|   Müzisyen|  Ankara|       8700|\n|    16|  Gençay| 46|     Berber|  Ankara|       8800|\n|    16|  Gençay| 46|     Berber|  Ankara|       8800|\n+------+--------+---+-----------+--------+-----------+\n\n"}]},"apps":[],"jobName":"paragraph_1563550052147_-1927629712","id":"20190425-092503_1533131817","dateCreated":"2019-07-19T15:27:32+0000","dateStarted":"2019-07-19T15:33:47+0000","dateFinished":"2019-07-19T15:33:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7214"},{"text":"%md\n## şema","user":"anonymous","dateUpdated":"2019-07-19T15:43:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>şema</h2>\n"}]},"apps":[],"jobName":"paragraph_1563550802148_1422302864","id":"20190719-154002_177890924","dateCreated":"2019-07-19T15:40:02+0000","dateStarted":"2019-07-19T15:43:47+0000","dateFinished":"2019-07-19T15:43:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7215"},{"text":"%pyspark\ndf.printSchema()","dateUpdated":"2019-07-19T15:27:32+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- sirano: integer (nullable = true)\n |-- isim: string (nullable = true)\n |-- yas: integer (nullable = true)\n |-- meslek: string (nullable = true)\n |-- sehir: string (nullable = true)\n |-- aylik_gelir: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1563550052149_-1929938205","id":"20190425-092502_1785391185","dateCreated":"2019-07-19T15:27:32+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7216"},{"text":"%md\n## Sütun Seçmek","user":"anonymous","dateUpdated":"2019-07-19T15:44:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Sütun Seçmek</h2>\n"}]},"apps":[],"jobName":"paragraph_1563550905679_1420099996","id":"20190719-154145_2133947779","dateCreated":"2019-07-19T15:41:45+0000","dateStarted":"2019-07-19T15:44:02+0000","dateFinished":"2019-07-19T15:44:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7217"},{"text":"%pyspark\ndf.select(\"sirano\",\"yas\").show(3)","user":"anonymous","dateUpdated":"2019-07-19T15:42:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+---+\n|sirano|yas|\n+------+---+\n|     1| 35|\n|     2| 42|\n|     3| 30|\n+------+---+\nonly showing top 3 rows\n\n"}]},"apps":[],"jobName":"paragraph_1563550901467_-197384380","id":"20190719-154141_2073978302","dateCreated":"2019-07-19T15:41:41+0000","dateStarted":"2019-07-19T15:42:43+0000","dateFinished":"2019-07-19T15:42:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7218"},{"text":"%md\n## Sütunlar Üzerinde Dönüşüm Yapmak","user":"anonymous","dateUpdated":"2019-07-19T15:44:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Sütunlar Üzerinde Dönüşüm Yapmak</h2>\n"}]},"apps":[],"jobName":"paragraph_1563550996290_-192443941","id":"20190719-154316_1712580758","dateCreated":"2019-07-19T15:43:16+0000","dateStarted":"2019-07-19T15:44:29+0000","dateFinished":"2019-07-19T15:44:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7219"},{"text":"%pyspark\ndf.select(\"yas\").withColumn(\"yas_carpi_100\", df.yas * 100).show(3)","user":"anonymous","dateUpdated":"2019-07-19T15:45:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-------------+\n|yas|yas_carpi_100|\n+---+-------------+\n| 35|         3500|\n| 42|         4200|\n| 30|         3000|\n+---+-------------+\nonly showing top 3 rows\n\n"}]},"apps":[],"jobName":"paragraph_1563550992482_-500243061","id":"20190719-154312_1476701177","dateCreated":"2019-07-19T15:43:12+0000","dateStarted":"2019-07-19T15:45:51+0000","dateFinished":"2019-07-19T15:45:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7220"},{"text":"%md\n## Filtreleme","user":"anonymous","dateUpdated":"2019-07-19T15:48:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Filtreleme</h2>\n"}]},"apps":[],"jobName":"paragraph_1563551310203_-665424577","id":"20190719-154830_2020123008","dateCreated":"2019-07-19T15:48:30+0000","dateStarted":"2019-07-19T15:48:40+0000","dateFinished":"2019-07-19T15:48:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7221"},{"text":"%pyspark\ndf.filter(\"aylik_gelir > 10000 \").show()","user":"anonymous","dateUpdated":"2019-07-19T15:53:08+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+--------+---+--------+--------+-----------+\n|sirano|    isim|yas|  meslek|   sehir|aylik_gelir|\n+------+--------+---+--------+--------+-----------+\n|     8|   Murat| 31|Müzisyen|Istanbul|      12000|\n|     9|   Ahmet| 33|  Doktor|  Ankara|      18000|\n|    10|Muhittin| 46|  Berber|Istanbul|      12000|\n|    14| Gülizar| 37|  Doktor|   İzmir|      14250|\n+------+--------+---+--------+--------+-----------+\n\n"}]},"apps":[],"jobName":"paragraph_1563551308589_374536375","id":"20190719-154828_162907393","dateCreated":"2019-07-19T15:48:28+0000","dateStarted":"2019-07-19T15:53:08+0000","dateFinished":"2019-07-19T15:53:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7222"},{"text":"%md\n## GROUP BY","user":"anonymous","dateUpdated":"2019-07-19T15:49:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>GROUP BY</h2>\n"}]},"apps":[],"jobName":"paragraph_1563551378418_-432407951","id":"20190719-154938_302262983","dateCreated":"2019-07-19T15:49:38+0000","dateStarted":"2019-07-19T15:49:59+0000","dateFinished":"2019-07-19T15:49:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7223"},{"text":"%pyspark\ndf.select(\"meslek\",\"aylik_gelir\").groupBy(\"meslek\").mean().show()","user":"anonymous","dateUpdated":"2019-07-19T15:50:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+------------------+\n|     meslek|  avg(aylik_gelir)|\n+-----------+------------------+\n|       Isci|            3500.0|\n|      Memur|4066.6666666666665|\n| Tuhafiyeci|            4800.0|\n|   Müzisyen|            9900.0|\n|Pazarlamaci| 5433.333333333333|\n|     Doktor|           16125.0|\n|     Berber| 9866.666666666666|\n|    Tornacı|            4200.0|\n+-----------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1563551382104_1004244442","id":"20190719-154942_1769733738","dateCreated":"2019-07-19T15:49:42+0000","dateStarted":"2019-07-19T15:50:58+0000","dateFinished":"2019-07-19T15:51:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7224"},{"text":"%md\n## Veri Türü Dönüşümü","user":"anonymous","dateUpdated":"2019-07-19T15:52:45+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Veri Türü Dönüşümü</h2>\n"}]},"apps":[],"jobName":"paragraph_1563550052150_-1928783958","id":"20190425-093835_564696777","dateCreated":"2019-07-19T15:27:32+0000","dateStarted":"2019-07-19T15:52:45+0000","dateFinished":"2019-07-19T15:52:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7225"},{"text":"%pyspark\n# aylik gelir double olsun\ndf2 = df.withColumn(\"aylik_gelir\", df.aylik_gelir.cast(\"double\"))","user":"anonymous","dateUpdated":"2019-07-19T15:56:57+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1563550052152_-1931092452","id":"20190425-092502_1362317835","dateCreated":"2019-07-19T15:27:32+0000","dateStarted":"2019-07-19T15:56:57+0000","dateFinished":"2019-07-19T15:56:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7226"},{"text":"%pyspark\ndf2.printSchema()","user":"anonymous","dateUpdated":"2019-07-19T15:56:59+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- sirano: integer (nullable = true)\n |-- isim: string (nullable = true)\n |-- yas: integer (nullable = true)\n |-- meslek: string (nullable = true)\n |-- sehir: string (nullable = true)\n |-- aylik_gelir: double (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1563550052153_-1931477201","id":"20190425-093716_668134561","dateCreated":"2019-07-19T15:27:32+0000","dateStarted":"2019-07-19T15:56:59+0000","dateFinished":"2019-07-19T15:56:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7227"},{"text":"%md\n## String Fonksiyonları","user":"anonymous","dateUpdated":"2019-07-19T15:54:02+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>String Fonksiyonları</h2>\n"}]},"apps":[],"jobName":"paragraph_1563550052155_-1930707703","id":"20190425-094612_436512494","dateCreated":"2019-07-19T15:27:32+0000","dateStarted":"2019-07-19T15:54:02+0000","dateFinished":"2019-07-19T15:54:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7228"},{"text":"%pyspark\nimport pyspark.sql.functions as f","user":"anonymous","dateUpdated":"2019-07-19T15:57:03+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1563550052154_-1930322954","id":"20190425-093726_1045149731","dateCreated":"2019-07-19T15:27:32+0000","dateStarted":"2019-07-19T15:57:03+0000","dateFinished":"2019-07-19T15:57:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7229"},{"text":"%pyspark\n# Burada concat örneği yapıyoruz\ndf3 = df2.withColumn(\"meslek_sehir\", f.concat(f.col(\"meslek\"), f.lit(\"-\"), f.col(\"sehir\")))\ndf3.show(3)","user":"anonymous","dateUpdated":"2019-07-19T15:57:13+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-----+---+--------+--------+-----------+-----------------+\n|sirano| isim|yas|  meslek|   sehir|aylik_gelir|     meslek_sehir|\n+------+-----+---+--------+--------+-----------+-----------------+\n|     1|Cemal| 35|    Isci|  Ankara|     3500.0|      Isci-Ankara|\n|     2|Ceyda| 42|   Memur| Kayseri|     4200.0|    Memur-Kayseri|\n|     3|Timur| 30|Müzisyen|Istanbul|     9000.0|Müzisyen-Istanbul|\n+------+-----+---+--------+--------+-----------+-----------------+\nonly showing top 3 rows\n\n"}]},"apps":[],"jobName":"paragraph_1563550052156_-1932631447","id":"20190425-094313_557969885","dateCreated":"2019-07-19T15:27:32+0000","dateStarted":"2019-07-19T15:57:13+0000","dateFinished":"2019-07-19T15:57:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7230"},{"text":"%md\n## SparkSQL","user":"anonymous","dateUpdated":"2019-07-19T15:54:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>SparkSQL</h2>\n"}]},"apps":[],"jobName":"paragraph_1563551674597_1255527634","id":"20190719-155434_1195194791","dateCreated":"2019-07-19T15:54:34+0000","dateStarted":"2019-07-19T15:54:49+0000","dateFinished":"2019-07-19T15:54:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7231"},{"text":"%pyspark\n# Mecvut bir dataframe'i sanki bir tabloymuş gibi kendi belirlediğimiz bir isimler kaydedelim. \n# Aşağıda buna keyfekeder dedik Harbiden de öyle, siz isterseniz sanliurfa diyebilirsiniz.\ndf3.createOrReplaceTempView(\"keyfekeder\")","user":"anonymous","dateUpdated":"2019-07-19T15:57:17+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1563550052157_-1933016196","id":"20190425-094758_1583410704","dateCreated":"2019-07-19T15:27:32+0000","dateStarted":"2019-07-19T15:57:17+0000","dateFinished":"2019-07-19T15:57:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7232"},{"text":"%pyspark\nspark.sql(\"\"\" \n\nselect * from keyfekeder limit 5\n\n\n\"\"\").show()","user":"anonymous","dateUpdated":"2019-07-19T15:57:20+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-------+---+-----------+--------+-----------+------------------+\n|sirano|   isim|yas|     meslek|   sehir|aylik_gelir|      meslek_sehir|\n+------+-------+---+-----------+--------+-----------+------------------+\n|     1|  Cemal| 35|       Isci|  Ankara|     3500.0|       Isci-Ankara|\n|     2|  Ceyda| 42|      Memur| Kayseri|     4200.0|     Memur-Kayseri|\n|     3|  Timur| 30|   Müzisyen|Istanbul|     9000.0| Müzisyen-Istanbul|\n|     4|  Burcu| 29|Pazarlamaci|  Ankara|     4200.0|Pazarlamaci-Ankara|\n|     5|Yasemin| 23|Pazarlamaci|   Bursa|     4800.0| Pazarlamaci-Bursa|\n+------+-------+---+-----------+--------+-----------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1563550052158_-1931861949","id":"20190425-095058_406170174","dateCreated":"2019-07-19T15:27:32+0000","dateStarted":"2019-07-19T15:57:20+0000","dateFinished":"2019-07-19T15:57:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7233"},{"text":"%md\n## Dataframe Join (En Çok İptal Edilen 10 Kategoriyi Bulma)","user":"anonymous","dateUpdated":"2019-07-19T16:08:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Dataframe Join (En Çok İptal Edilen 10 Kategoriyi Bulma)</h2>\n"}]},"apps":[],"jobName":"paragraph_1563551850542_1106907289","id":"20190719-155730_469897224","dateCreated":"2019-07-19T15:57:30+0000","dateStarted":"2019-07-19T16:08:32+0000","dateFinished":"2019-07-19T16:08:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7234"},{"text":"%pyspark\n\n# retail_db vveri tabındaki tabloları birleştirelim\norder_items = spark.read.format(\"csv\").option(\"header\",True).option(\"inferSchema\",True).option(\"sep\",\",\").load(\"/user/erkan/retail_db/order_items.csv\")\norders = spark.read.format(\"csv\").option(\"header\",True).option(\"inferSchema\",True).option(\"sep\",\",\").load(\"/user/erkan/retail_db/orders.csv\")\nproducts = spark.read.format(\"csv\").option(\"header\",True).option(\"inferSchema\",True).option(\"sep\",\",\").load(\"/user/erkan/retail_db/products.csv\")\ncategories = spark.read.format(\"csv\").option(\"header\",True).option(\"inferSchema\",True).option(\"sep\",\",\").load(\"/user/erkan/retail_db/categories.csv\")\n","user":"anonymous","dateUpdated":"2019-07-19T16:04:58+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1563550052159_-1932246698","id":"20190425-095206_1782442474","dateCreated":"2019-07-19T15:27:32+0000","dateStarted":"2019-07-19T16:04:59+0000","dateFinished":"2019-07-19T16:05:01+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7235"},{"text":"%pyspark\n# Products ile kategorileri birleştirme\ndf_prod_cat = products.join(categories, products.productCategoryId == categories.categoryId, \"inner\")\nz.show(df_prod_cat.limit(2))","user":"anonymous","dateUpdated":"2019-07-19T16:06:50+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"productId\tproductCategoryId\tproductName\tproductDescription\tproductPrice\tproductImage\tcategoryId\tcategoryDepartmentId\tcategoryName\n1\t2\tQuest Q64 10 FT. x 10 FT. Slant Leg Instant U\tnull\t59.98\thttp://images.acmesports.sports/Quest+Q64+10+FT.+x+10+FT.+Slant+Leg+Instant+Up+Canopy\t2\t2\tSoccer\n2\t2\tUnder Armour Men's Highlight MC Football Clea\tnull\t129.99\thttp://images.acmesports.sports/Under+Armour+Men%27s+Highlight+MC+Football+Cleat\t2\t2\tSoccer\n"}]},"apps":[],"jobName":"paragraph_1563550052160_-1946482408","id":"20190425-124847_1580408308","dateCreated":"2019-07-19T15:27:32+0000","dateStarted":"2019-07-19T16:05:44+0000","dateFinished":"2019-07-19T16:05:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7236"},{"text":"%pyspark\n# orderItems ile yukarıda birleştirilen ürün-kategori df'i birleştirme\ndf_order_items_cat = order_items.join(df_prod_cat, order_items.orderItemProductId == df_prod_cat.productId, 'left')\nz.show(df_order_items_cat.limit(5))","user":"anonymous","dateUpdated":"2019-07-19T16:07:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"orderItemName\torderItemOrderId\torderItemProductId\torderItemQuantity\torderItemSubTotal\torderItemProductPrice\tproductId\tproductCategoryId\tproductName\tproductDescription\tproductPrice\tproductImage\tcategoryId\tcategoryDepartmentId\tcategoryName\n5\t4\t897\t2\t49.98\t24.99\t897\t40\tTeam Golf New England Patriots Putter Grip\tnull\t24.99\thttp://images.acmesports.sports/Team+Golf+New+England+Patriots+Putter+Grip\t40\t6\tAccessories\n2\t2\t1073\t1\t199.99\t199.99\t1073\t48\tPelican Sunstream 100 Kayak\tnull\t199.99\thttp://images.acmesports.sports/Pelican+Sunstream+100+Kayak\t48\t7\tWater Sports\n3\t2\t502\t5\t250.0\t50.0\t502\t24\tNike Men's Dri-FIT Victory Golf Polo\tnull\t50.0\thttp://images.acmesports.sports/Nike+Men%27s+Dri-FIT+Victory+Golf+Polo\t24\t5\tWomen's Apparel\n151393\t60491\t627\t5\t199.95\t39.99\t627\t29\tUnder Armour Girls' Toddler Spine Surge Runni\tnull\t39.99\thttp://images.acmesports.sports/Under+Armour+Girls%27+Toddler+Spine+Surge+Running+Shoe\t29\t5\tShop By Sport\n1\t1\t957\t1\t299.98\t299.98\t957\t43\tDiamondback Women's Serene Classic Comfort Bi\tnull\t299.98\thttp://images.acmesports.sports/Diamondback+Women%27s+Serene+Classic+Comfort+Bike+2014\t43\t7\tCamping & Hiking\n"}]},"apps":[],"jobName":"paragraph_1563550052161_-1946867157","id":"20190425-124945_899278392","dateCreated":"2019-07-19T15:27:32+0000","dateStarted":"2019-07-19T16:06:07+0000","dateFinished":"2019-07-19T16:06:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7237"},{"text":"%pyspark\nimport pyspark.sql.functions as f","user":"anonymous","dateUpdated":"2019-07-19T16:08:43+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1563550052164_-1948021403","id":"20190425-125741_1889127677","dateCreated":"2019-07-19T15:27:32+0000","dateStarted":"2019-07-19T16:08:43+0000","dateFinished":"2019-07-19T16:08:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7238"},{"text":"%pyspark\nfinal_df = df_order_items_cat.join(orders, df_order_items_cat.orderItemOrderId == orders.orderId)\nfinal_df.where(f.col('orderStatus') == \"CANCELED\").groupBy(\"categoryName\").agg(f.sum(\"orderItemSubTotal\").alias(\"toplam\")).sort(f.desc(\"toplam\")).limit(10).show()","user":"anonymous","dateUpdated":"2019-07-19T16:08:46+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------------------+\n|        categoryName|            toplam|\n+--------------------+------------------+\n|             Fishing|134393.27999999965|\n|              Cleats| 85785.70000000016|\n|    Cardio Equipment| 81351.93000000001|\n|    Camping & Hiking|  80094.6600000001|\n|        Water Sports|  66196.6899999998|\n|     Women's Apparel|           65750.0|\n|      Men's Footwear| 60705.32999999974|\n|Indoor/Outdoor Games| 58126.74000000006|\n|       Shop By Sport| 27423.43999999998|\n|         Electronics| 5685.500000000001|\n+--------------------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1563550052165_-1948406152","id":"20190425-125506_1721876191","dateCreated":"2019-07-19T15:27:32+0000","dateStarted":"2019-07-19T16:08:47+0000","dateFinished":"2019-07-19T16:08:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7239"},{"text":"%pyspark\n","dateUpdated":"2019-07-19T15:27:32+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1563550052166_-1947251905","id":"20190425-130155_1658611086","dateCreated":"2019-07-19T15:27:32+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7240"}],"name":"big-data/05-Duragan-Veri-Analizi/02_apache_spark_dataframe_structured_api/dataframe_giris_ve_en_cok_iptal_edilen_urunler","id":"2EHJZ3N36","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}